<% if @monitored %>
  $('posts_list').update("<%= escape_javascript(render(:partial => 'posts_list', :object => @monitored_posts, :as => :posts))%>");
<% else %>
  $('posts_list').update("<%= escape_javascript(render(:partial => 'posts_list', :object => @posts, :as => :posts))%>");
<% end %>
history.replaceState(null, 'Posts', "<%= posts_path %><%= 
  p = []
  p << %{monitored=true} if @monitored
  p << %{page=} + params[:page] if params[:page]
  p << %{utf8=} + params[:utf8] if params[:utf8]
  p << %{q=} + @q if @q
  p << %{user_id=} + params[:user_id] if params[:user_id]
  p << %{topic_id=} + params[:topic_id] if params[:topic_id]
  %{?} + p.join(%{&}) unless p.empty?
%>");